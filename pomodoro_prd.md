# PRD: Minimalist Pomodoro Timer

## Обзор проекта

**Название проекта:** Enhanced Pomatez with Activity Tracking  
**Путь проекта:** `c:\Projects\_Others\0808_pomodoro-db\`  
**Базовая технология:** Electron 18 + React + TypeScript (расширение Pomatez)  
**Цель:** Интеграция системы трекинга активности в современный Pomodoro-таймер Pomatez

## Проблематика

Существующие Pomodoro-таймеры имеют следующие недостатки:

- Отсутствие реального трекинга активности пользователя
- Нет API для интеграции с ОС и внешними системами
- Невозможность анализа реальной продуктивности
- Устаревшие технологические стеки (Vue 2, старый Electron)
- Слабое развитие проектов (например, Pomotroid не обновляется с 2022 года)

**Решение:** Расширить современный проект Pomatez (активно развивающийся в 2025) системой автоматического трекинга активности через Windows API.

## Целевая аудитория

- Разработчики и knowledge workers
- Пользователи техники Pomodoro с опытом
- Люди, ценящие минималистичный дизайн и функциональность

## Функциональные требования

### Этап 1: Интеграция API

#### 1.1 Система трекинга активности

- **Мониторинг активности:** Отслеживание движения мыши/клавиатуры через Windows API
- **Интервалы записи:** Каждые 5 минут
- **Порог неактивности:** 3 минуты отсутствия активности = неактивный интервал
- **Формат данных:** JSON с битовыми масками активности

#### 1.2 Структура данных помидорки

```json
{
  "id": "unique-id",
  "path": "project-path",
  "title": "task-title",
  "status": "running|paused|completed",
  "fill_color": "#4CAF50",
  "total_minutes": 375,
  "aggregated_minutes": 375,
  "description": "описание задачи",
  "daily_masks": {
    "2025-07-30": "000000000000001111111111101111111111111111111"
  }
}
```

#### 1.3 API операции

- Создание новой сессии помидорки
- Обновление статуса (запуск/пауза/стоп)
- Запись интервалов активности в битовую маску
- Подсчет общего времени активности
- Чтение/запись JSON файлов

### Этап 2: Минималистичный интерфейс

#### 2.1 Дизайн окна

- **Формат отображения:** Только цифры MM:SS крупным шрифтом
- **Стиль:** Минималистичный, как в примере Unisender
- **Прогресс-бар:** Тонкая полоска снизу (опционально)
- **Позиционирование:** Always on top

#### 2.2 Размеры окна

- **Small:** 75% от базового размера
- **Normal:** 100% (по умолчанию)
- **Large:** 125% для больших мониторов

#### 2.3 Управление

- **Левый клик по таймеру:** Пауза/возобновление
- **Правый клик:** Контекстное меню
- **Горячие клавиши:**
  - `Space` - пауза/возобновление
  - `Ctrl+S` - старт помидорки
  - `Ctrl+R` - сброс таймера
  - `Ctrl+1/2/3` - размер окна Small/Normal/Large

#### 2.4 Контекстное меню

```
Start Pomodoro (25 min)
Start Short Break (5 min)
Start Long Break (15 min)
─────────────────────────
Pause/Resume
Stop
─────────────────────────
☑ Show Progress Bar
Window Size → Small | Normal | Large
Settings
─────────────────────────
Exit
```

### Технические требования

### Архитектура

- **База:** Расширение проекта Pomatez (https://github.com/zidoro/pomatez)
- **Технологии:** Electron 18, React, TypeScript, Redux Toolkit
- **Платформа:** Windows (приоритет), macOS/Linux (возможно)

### Хранение данных

- **Данные помидорок:** JSON файлы через расширенный SafeStore
- **Настройки приложения:** Интеграция с существующей системой настроек Pomatez
- **Битовые маски активности:** Ежедневные файлы с 5-минутными интервалами

### Настройки API

```json
{
  "trackingEnabled": true,
  "activityThresholdSeconds": 180,
  "intervalDurationMinutes": 5,
  "showActivityIndicator": true,
  "autoCreateSessions": true,
  "saveDetailedLogs": false
}
```

## Этапы разработки

### Этап 1: API интеграция в Pomatez (Приоритет: Высокий)

- [ ] Клонирование и изучение проекта Pomatez ✅
- [ ] Анализ архитектуры (Electron 18 + React + TypeScript) ✅
- [ ] Расширение SafeStore для данных помидорок
- [ ] Создание Redux slice для трекинга активности
- [ ] Интеграция Windows API для мониторинга активности
- [ ] Настройка IPC коммуникации между main и renderer
- [ ] Тестирование записи данных активности

### Этап 2: UI интеграция (Приоритет: Средний)

- [ ] Добавление индикатора активности в существующий Timer
- [ ] Интеграция с системой настроек Pomatez
- [ ] Создание компонентов для статистики активности
- [ ] Настройка автоматического создания сессий
- [ ] Middleware для синхронизации с Timer состоянием
- [ ] Тестирование интеграции с существующим функционалом

## Критерии успеха

### Функциональные

- Точное отслеживание реальной активности пользователя
- Корректная запись данных в JSON формат
- Стабильная работа таймера без сбоев
- Быстрый отклик интерфейса

### UX

- Интерфейс не отвлекает от работы
- Удобное управление без переключения фокуса
- Настройки сохраняются между сессиями
- Четкая видимость таймера на любом фоне

### Ограничения и риски

### Технические ограничения

- Зависимость от Windows API для мониторинга активности
- Необходимость работы в фоновом режиме
- Требования к правам доступа для мониторинга системы
- Производительность при постоянном мониторинге

### Риски

- Возможные конфликты с антивирусами при мониторинге активности
- Потребление ресурсов при постоянной работе в фоне
- Совместимость с различными версиями Windows
- Изменения в архитектуре базового проекта Pomatez

## Будущие возможности

- **Кросс-платформенная поддержка** - адаптация под macOS и Linux
- **Облачная синхронизация** - сохранение данных в облаке
- **Интеграция с календарями** - связь с Google Calendar, Outlook
- **Расширенная аналитика** - графики продуктивности, отчеты
- **API для внешних интеграций** - подключение к Jira, Asana, etc.
- **Машинное обучение** - персонализированные рекомендации
